<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Extjs - Timeline - Helloworld</title>
<link rel="stylesheet" href="extjs/resources/css/ext-all.css"
	type="text/css"></link>
<style>
.play {
  background-image: url(famfamfam_silk_icons/icons/control_play.png) !important;
}

.pause {
  background-image: url(famfamfam_silk_icons/icons/control_pause.png) !important;
}

.rewind {
  background-image: url(famfamfam_silk_icons/icons/control_rewind.png) !important;
}

.scrubber {
	stroke: red;
	fill: red;
	cursor: pointer;
	width: 2px;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

</style>
<script type="text/javascript" src="extjs/ext-all-dev.js"></script>
<script type="text/javascript" src="d3/d3.v3.js"></script>
<script type="text/javascript">

Ext.require([
   'Ext.window.Window',
   'Ext.form.field.Text',
   'Ext.form.field.ComboBox'
]);

Ext.onReady(function() {

	Ext.create('Ext.window.Window', {
		width : 500,
		height : 400,
		title : 'GPS',
		layout: 'border',
		maximizable: true,
		x: 10,
		y: 10,
		html: 'Satelite map with track of bird'
	}).show();

	Ext.create('Ext.window.Window', {
		width : 500,
		height : 400,
		title : 'Video',
		layout: 'border',
		maximizable: true,
		x: 520,
		y: 10,
		html: 'Video of bird'
	}).show();
	
	Ext.define('Esc.timeline.Canvas', {
		extend : 'Ext.Component',
			alias: 'widget.timelinecanvas',
			autoEl: {
				tag: 'svg'
			},
			onResize: function() {
                var canvas = this.getEl().dom;
				var width = canvas.clientWidth;
		        var height = canvas.clientHeight;

		        if (canvas.width === width && canvas.height === height) {
		            return;
		        }

		        canvas.width = width;
		        canvas.height = height;
			},
	afterRender: function() {
var canvas = this.getEl().dom;
var width = canvas.clientWidth;
var height = canvas.clientHeight;
var svg = this.svg = d3.select(canvas);

var dateParse = d3.time.format("%Y-%m-%dT%H:%M:%SZ").parse;
var x = d3.time.scale().range([0, width]).domain([dateParse('2010-06-28T00:22:47Z'), dateParse('2010-06-28T17:40:42Z')]);
var xAxis = d3.svg.axis().scale(x).orient("bottom"); // .tickFormat(d3.time.format("%Y-%m-%dT%H:%M:%SZ")).ticks(8);

svg.append("g")
    .attr("class", "x axis")
    .attr("transform", "translate(0,30)")
    .call(xAxis);

svg.append("g")
    .attr("class", "x axis")
    .attr("transform", "translate(0, "+(height-50)+")")
    .call(xAxis);

var currentTime = dateParse('2010-06-28T08:22:47Z');

svg.append("line")
.attr('x1', x(currentTime))
.attr('y1', 0)
.attr('x2', x(currentTime))
.attr('y2', height)
.attr('class', 'scrubber')
;

svg.append("circle").attr('cx', x(currentTime)).attr('cy', 16).attr('r', 7).attr('class', 'scrubber')
;



},
	});

	Ext.create('Ext.window.Window', {
		width : 1010,
		height : 500,
		title : 'Timeline',
		layout: 'border',
		maximizable: true,
		x: 10,
		y: 420,
		items: [{
			region: 'center',
			xtype: 'timelinecanvas',
//			html: 'Time line tracks with annotation events + Sensor graphs tracks',
			dockedItems: [{
			    xtype: 'toolbar',
			    dock: 'top',
			    items: [{
					id: 'progress',
					xtype: 'textfield',
					value: '0'
				}, {
					xtype: 'combo',
					store: [1, 10, 50, 100, 200, 500],
					value: 100,
					width: 50,
					listeners: {
						change: function(field, value) {
							animationController.clock.multiplier = value*1.0;
						}
					}
				} ,{
					iconCls: 'play',
					toolTip: 'Play',
					handler: function() { animationController.play(); }
				}, {
					iconCls: 'pause',
					toolTip: 'Pause',
					handler: function() { animationController.pause(); }
				}, {
					iconCls: 'rewind',
					toolTip: 'Rewind',
					handler: function() { animationController.reset(); }
				}]
			}]
		}, {
			region: 'east',
			width: 200,
			xtype: 'tabpanel',
			items: [{
				title: 'Palette',
				toolTip: 'Events to add to timeline track',
				defaults: {
					xtype: 'button'
				},
				layout: {
					type: 'vbox',
					padding: 10,
					align: 'stretch'
				},
				items: [{
					text: 'Fly'
				}, {
					text: 'Sit'
				}]
			}, {
				title: 'Selected',
				html: 'Info/edit event selected in timeline track'
			}]
		}]
	}).show();
});

</script>
</head>
</html>
